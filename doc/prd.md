# Project Requirements Document (PRD)

## 1. 文档概述

* **项目名称：** 生日快乐 (Project Birthday)
* **目标：** 提供一个清爽、简洁、充满仪式感的生日倒计时与祝福工具。
* **核心色调：** 浅粉 (#FFD1DC) 与 浅蓝 (#B3E5FC)。

## 2. 技术栈

* **构建工具：** Bun + Vite
* **框架：** Vue 3 (Composition API)
* **日期处理：** `date-fns` (公历) + `lunar-javascript` (农历转换)
* **状态管理：** LocalStorage (持久化配置)

## 3. 功能详细说明

### 3.1 核心逻辑：时间计算与授时

* **双重授时：**
1. 初始化时请求授时 API（如 `https://api.m.taobao.com/rest/api3.do?api=mtop.common.getTimestamp`）。
2. 计算 `Offset = ServerTime - LocalTime`。
3. 全局倒计时使用 `Ref(Date.now() + Offset)` 驱动。


* **生日计算：**
* **公历：** 若不输入年份，默认取当前年份；若今年已过，则计算目标为明年。
* **农历：** 使用万年历库将农历转换为当年的公历日期。需处理闰月逻辑（默认取第一个农历月）。



### 3.2 界面状态机 (Core Logic)

系统根据当前时间  与 目标生日时间  的差值  展示不同界面：

| 时间差条件 () | 界面展示内容 | 备注 |
| --- | --- | --- |
| **当天** () | **生日祝福模板** | 包含称呼、生日日期、温暖寄语。 |
| **倒计时 A** () | **时 : 分 : 秒** 倒计时 | 极度紧迫感，显示星期、农历日期。 |
| **倒计时 B** () | **天 : 时 : 分 : 秒** 倒计时 | 期待感。 |
| **刚刚过去** (生日结束后  内) | **生日快乐 + 已过去 XX 小时...** | 留恋感。 |
| **平时状态** (其他所有时间) | **距上个生日已过... / 距下个生日还有...** | 常规跨度显示。 |

### 3.3 交互需求

* **配置模态框：** 点击右上角齿轮，输入/修改称呼、生日类型（公历/农历）、日期（月/日必填，年选填）。
* **分享功能：** * 点击分享按钮，将配置对象 JSON 化后进行 `Base64` 编码。
* 生成 URL：`https://domain.com/?data=eyJuYW1lIjogI...`
* 自动复制到剪贴板，并触发一个轻量级的 Toast 提示。


* **数据优先级：** URL 参数 > LocalStorage > 默认空状态。

## 4. 边界情况处理 (Edge Cases)

1. **2月29日生日：** 若是非闰年，自动修正为 2月28日 或 3月1日（需代码逻辑固定一种，建议 2月28日）。
2. **跨年计算：** 计算“下一个生日”时，如果当前月份大于生日月份，年份必须 +1。
3. **无年份输入：** UI 隐藏“周岁”显示，仅计算倒计时。若有年份，则在祝福模板中增加“这是你来到世界的第 X 天”等感性文案。
4. **离线状态：** 若授时 API 请求失败，直接降级使用用户本地系统时间。

## 5. 视觉规范

* **背景：** 使用线性渐变 (Linear Gradient)，从左上角浅蓝过渡到右下角浅粉。
* **字体：** 优先使用系统圆体（如 `PingFang SC`, `Rounded` 系列），增加温柔感。
* **动效：** * 数字跳动使用 `tabular-nums` 字体样式防止抖动。
* 生日当天自动触发 Canvas 纸屑特效。